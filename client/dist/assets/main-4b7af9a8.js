(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}})();class l{constructor(){this.centralCardCallbacks=[],this.handCardCallbacks=[],this.initializeUI()}initializeUI(){}showLobby(){this.showScreen("lobby")}showWaitingRoom(e){document.getElementById("displayGameCode").textContent=e,this.showScreen("waitingRoom")}showGameScreen(){this.showScreen("gameScreen")}showGameOver(e){const t=document.getElementById("gameResult");t.textContent=e?"You Win! ðŸŽ‰":"You Lost! ðŸ’«",t.style.color=e?"#4CAF50":"#f44336",this.showScreen("gameOverScreen")}showScreen(e){document.querySelectorAll(".screen").forEach(t=>{t.classList.remove("active")}),document.getElementById(e).classList.add("active")}updateGameState(e,t){this.showGameScreen(),document.getElementById("targetNumber").textContent=e.targetNumber.toString(),document.getElementById("tokenPosition").textContent=e.tokenPosition.toString();const i=document.getElementById("turnIndicator"),n=e.currentPlayerId===t;i.textContent=n?"Your Turn!":"Opponent's Turn",i.className=`turn-indicator ${n?"your-turn":""}`,this.updateNumberLine(e.tokenPosition,e.targetNumber),this.updateCentralRow(e.centralRow,n),this.updatePlayerHand(e,t),this.updateOpponentInfo(e,t)}updateNumberLine(e,t){const i=document.querySelector(".line"),n=document.getElementById("gameToken"),r=document.getElementById("targetMarker");i.getBoundingClientRect().width;const s=Math.max(t,e)+5,o=e/s*100,c=t/s*100;n.style.left=`calc(${o}% + 20px)`,r.style.left=`calc(${c}% + 20px)`,r.textContent=t.toString()}updateCentralRow(e,t){const i=document.getElementById("centralCards");i.innerHTML="",e.forEach(n=>{const r=this.createCardElement(n,t);i.appendChild(r)})}updatePlayerHand(e,t){const i=e.players.find(r=>r.id===t),n=document.getElementById("playerHand");if(n.innerHTML="",i){const r=e.currentPlayerId===t,a=e.maxPosition||50;i.hand.forEach(s=>{const o=this.createCardElement(s,r);if(r){const c=this.calculateNewPosition(e.tokenPosition,s);(c<0||c>a)&&(o.classList.add("illegal-move"),o.title=`This move would go to position ${c}, which is out of bounds (0-${a})`)}n.appendChild(o)})}}calculateNewPosition(e,t){switch(t.operation){case"add":return e+t.numericValue;case"subtract":return e-t.numericValue;case"multiply":return e*t.numericValue;default:return e}}updateOpponentInfo(e,t){const i=e.players.find(r=>r.id!==t),n=document.getElementById("opponentHand");if(n.innerHTML="",i)for(let r=0;r<i.hand.length;r++){const a=document.createElement("div");a.className="card disabled",a.textContent="?",n.appendChild(a)}}createCardElement(e,t){const i=document.createElement("div");return i.className=`card ${this.getCardType(e)}`,i.textContent=e.display,i.dataset.cardId=e.id,t?(i.style.cursor="pointer",i.addEventListener("click",()=>this.handleCardClick(e.id))):i.classList.add("disabled"),i}getCardType(e){return e.operation==="multiply"?"multiply":e.numericValue>=0?"positive":"negative"}handleCardClick(e){this.centralCardCallbacks.forEach(t=>t(e)),this.handCardCallbacks.forEach(t=>t(e))}onCentralCardClick(e){this.centralCardCallbacks.push(e)}onHandCardClick(e){this.handCardCallbacks.push(e)}}class u{constructor(e,t){this.socket=e,this.ui=t,this.currentGameId="",this.playerId=e.id||"",this.setupCardEventListeners(),e.on("connect",()=>{this.playerId=e.id||""})}setGameId(e){this.currentGameId=e}updateGameState(e){this.currentGameState=e,this.ui.updateGameState(e,this.playerId),e.gameStatus==="finished"&&this.ui.showGameOver(e.winnerId===this.playerId)}setupCardEventListeners(){this.ui.onCentralCardClick(e=>{!this.currentGameState||this.currentGameState.currentPlayerId!==this.playerId||this.socket.emit("draftCard",{gameId:this.currentGameId,cardId:e})}),this.ui.onHandCardClick(e=>{!this.currentGameState||this.currentGameState.currentPlayerId!==this.playerId||this.socket.emit("playCard",{gameId:this.currentGameId,cardId:e})})}}class m{constructor(){this.currentGameId="",this.socket=io("http://localhost:3001"),this.ui=new l,this.game=new u(this.socket,this.ui),this.initializeEventListeners(),this.setupSocketListeners()}initializeEventListeners(){document.getElementById("createGame").addEventListener("click",()=>this.createGame()),document.getElementById("joinGame").addEventListener("click",()=>this.joinGame()),document.getElementById("playAgain").addEventListener("click",()=>this.playAgain()),document.getElementById("playerName").addEventListener("keypress",e=>{e.key==="Enter"&&this.createGame()}),document.getElementById("gameCode").addEventListener("keypress",e=>{e.key==="Enter"&&this.joinGame()})}setupSocketListeners(){this.socket.on("gameCreated",e=>{this.currentGameId=e.gameId,this.game.setGameId(e.gameId),this.ui.showWaitingRoom(e.gameId)}),this.socket.on("gameStateUpdate",e=>{this.game.updateGameState(e)}),this.socket.on("error",e=>{alert("Error: "+e)})}createGame(){const e=document.getElementById("playerName").value.trim();if(!e){alert("Please enter your name");return}this.socket.emit("createGame",e)}joinGame(){const e=document.getElementById("playerName").value.trim(),t=document.getElementById("gameCode").value.trim().toUpperCase();if(!e||!t){alert("Please enter both your name and game code");return}this.socket.emit("joinGame",t,e),this.currentGameId=t,this.game.setGameId(t)}playAgain(){this.ui.showLobby(),document.getElementById("playerName").value="",document.getElementById("gameCode").value=""}}document.addEventListener("DOMContentLoaded",()=>{new m});
